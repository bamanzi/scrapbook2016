<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"> <title>Linux: Force Close A Socket / Port On Server In a TIME_WAIT State</title><link rel="canonical" href="http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/"><link rel="alternate" type="application/rss+xml" title="nixCraft feed" href="http://www.cyberciti.biz/faq/feed/"><link rel="pingback" href="http://www.cyberciti.biz/faq/xmlrpc.php"><link rel="dns-prefetch" href="http://s.w.org/"><link rel="alternate" type="application/rss+xml" title="nixCraft » Linux: Force Close A Socket / Port On Server In a TIME_WAIT State Comments Feed" href="http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/feed/">   <link rel="https://api.w.org/" href="http://www.cyberciti.biz/faq/wp-json/"><link rel="alternate" type="application/json+oembed" href="http://www.cyberciti.biz/faq/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.cyberciti.biz%2Ffaq%2Flinux-command-forcibly-close-socket-ports-in-time_wait-state%2F"><link rel="alternate" type="text/xml+oembed" href="http://www.cyberciti.biz/faq/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.cyberciti.biz%2Ffaq%2Flinux-command-forcibly-close-socket-ports-in-time_wait-state%2F&amp;format=xml"><meta name="description" content="This guide explains command to immediately force and remove Linux socket/ports that are in the TIME_WAIT state. "><link rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head><body class="template-single">  <div class="container"> <span class="menu_control">≡ Menu</span><ul id="menu-faq" class="menu"><li id="menu-item-145282" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-145282"><a title="nixCraft – Home Page " href="http://www.cyberciti.biz/">Home</a></li><li id="menu-item-145280" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-145280"><a title="About us" href="http://www.cyberciti.biz/tips/about-us">About</a></li><li id="menu-item-145283" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-145283"><a href="https://bash.cyberciti.biz/guide/Main_Page">Linux Shell Scripting TutoriaL</a></li><li id="menu-item-145281" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-145281"><a title="Rss Feed" href="http://www.cyberciti.biz/nixcraft-rss-feed-syndication/">RSS/Feed</a></li></ul><div id="header" class="header"><div id="site_title"><a href="http://www.cyberciti.biz/faq">nixCraft</a></div><div id="site_tagline">Linux and Unix tutorials for new and seasoned sysadmin.</div></div><div class="columns"><div class="content"><div id="post-13215" class="post_box grt top" itemscope="" itemtype="http://schema.org/Article"><meta itemscope="" itemprop="mainEntityOfPage" itemtype="https://schema.org/WebPage" itemid="http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/"><div class="headline_area"><h1 class="headline" itemprop="headline">Linux: Force Close A Socket / Port On Server In a TIME_WAIT State</h1><div class="byline small"> <span class="post_author_intro">by</span> <span class="post_author">Vivek Gite</span> <span class="post_date_intro">on</span> <span class="post_date" title="2013-04-09">April 9, 2013<span style="font-style: italic; text-transform: lowercase;"> last updated </span>March 10, 2014</span><div class="post_cats"> <span class="post_cats_intro">in</span> <a href="http://www.cyberciti.biz/faq/category/linux/" rel="category tag">Linux</a>, <a href="http://www.cyberciti.biz/faq/category/networking/" rel="category tag">Networking</a>, <a href="http://www.cyberciti.biz/faq/category/troubleshooting/" rel="category tag">Troubleshooting</a></div></div></div><div class="post_content"><p></p><div class="my_story"><a title="See all Troubleshooting related FAQ" href="http://www.cyberciti.biz/faq/category/troubleshooting/"><img src="configure.png" alt="" border="0"></a></div><span class="drop_cap">I</span> run a BT client and few other server program on Linux. Sometime these programs get overloaded with too many connections and crashes. If I restart my apps, I see lots of old IPs in a TIME_WAIT state. How do I force and and close everything in a TIME_WAIT state under Linux operating systems?<br> <span id="more-13215"></span><br> TIME-WAIT state can exists on either server or client program. It represents waiting for enough time to pass to be sure the remote TCP received the acknowledgment of its connection termination request. The <kbd>/proc/sys/net/ipv4/tcp_fin_timeout</kbd> setting determines the time that must elapse before TCP/IP can release a closed connection and reuse its resources. This is known as TIME_WAIT state. TIME_WAIT is a normal part of the TCP connection. However, if you must close a socket in TIME_WAIT state, try:<p></p><center>  <ins class="adsbygoogle" style="display: inline-block; width: 336px; height: 280px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="2404767461"></ins> <p></p></center><p></p><p>[a] Restart the networking service</p><p>[b] <a href="http://www.cyberciti.biz/tips/cutting-the-tcpip-network-connection-with-cutter.html">cutter command</a></p><h2>Finding out current TIME_WAIT settings</h2><p>Type the following command<br> <code>$ cat /proc/sys/net/ipv4/tcp_fin_timeout</code><br> Sample outputs:</p><pre>60</pre><p>You can lower the value by typing the following command as root user:<br> <code># echo 20 &gt; /proc/sys/net/ipv4/tcp_fin_timeout</code><br> To set <kbd>/proc/sys/net/ipv4/tcp_fin_timeout</kbd> to 20 permanently, edit the file <kbd><a href="http://www.cyberciti.biz/faq/making-changes-to-proc-filesystem-permanently/">/etc/sysctl.conf</a></kbd> and set it as follows:</p><pre>net.ipv4.tcp_fin_timeout=20</pre><h3>Restating the network service</h3><p>To restart the network service under RHEL / CentOS based systems, enter:<br> <code># service network restart</code><br> OR<br> <code># /etc/init.d/network restart</code><br> Ubuntu / Debian Linux, user try the following command:<br> <code>$ <a href="http://www.cyberciti.biz/faq/ubuntu-restart-start-stop-networking-service-howto/">sudo service networking restart</a></code><br> OR<br> <code>$ <a href="http://www.cyberciti.biz/faq/linux-restart-network-interface/">sudo /etc/init.d/networking restart</a></code></p><h3>cutter command</h3><p>Cutter is an open source program that allows Linux firewall administrators to abort TCP/IP connections routed over the firewall or router on which it is run.</p><h4>Examples</h4><p>To cut all connections from 192.168.1.10 to server, enter:<br> <code># cutter 192.168.1.10</code><br> To cut all ssh connection from 192.168.1.1 to server, type:<br> <code># cutter 192.168.1.1 22</code><br> To cut all http connection from 192.168.1.5 to ssh server 202.54.1.20, run:<br> <code># cutter 202.54.1.20 192.168.1.5 80</code><br> See <a href="http://www.cyberciti.biz/tips/cutting-the-tcpip-network-connection-with-cutter.html">how to install and use the cutter command</a> for more information here.</p><h5>See also</h5><p>See the following man pages:<br> <code>man 7 socket<br> man 7 tcp<br> man 7 ip<br> man 5 proc</code></p> <strong>Share this tutorial on:</strong><div class="nixcraft-social"><a class="nixcraft-link nixcraft-twitter" href="https://twitter.com/intent/tweet?text=Linux%3A+Force+Close+A+Socket+%2F+Port+On+Server+In+a+TIME_WAIT+State&amp;url=http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/&amp;via=nixcraft" title="Tweet this tutorial/page">Twitter</a><a class="nixcraft-link nixcraft-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/" title="Share this page/tutorial on Facebook">Facebook</a><a class="nixcraft-link nixcraft-googleplus" href="https://plus.google.com/share?url=http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/" title="Share this page/tutorial on Google+">Google+</a><a class="nixcraft-link nixcraft-pdf" href="http://www.cyberciti.biz/view/pdf/faq/13215.php" title="Download this tutorial/faq as a free pdf">Download PDF version </a><a class="nixcraft-link nixcraft-error" href="https://nixcraft.wufoo.com/forms/give-us-feedback-for-nixcraft/def/Field209=http://www.cyberciti.biz/faq/linux-command-forcibly-close-socket-ports-in-time_wait-state/&amp;Field211=Linux:%20Force%20Close%20A%20Socket%20/%20Port%20On%20Server%20In%20a%20TIME_WAIT%20State" target="_blank" title="Click here to report Typo/Grammar and other Incorrect information">Found an error/typo on this page?</a></div><div class="crp_related "><div class="my_tutorial_series">About the author: Vivek Gite is a seasoned sysadmin and a trainer for the Linux/Unix &amp; shell scripting. Follow him on <strong><a href="https://twitter.com/nixcraft" style="text-decoration: underline;">Twitter</a></strong>. OR <strong>read more like this</strong>:<ul><li><a href="http://www.cyberciti.biz/faq/warning-got-duplicate-tcp-line-netstat-error-and-solution/" class="crp_title">Warning, got duplicate tcp line – netstat error and solution</a></li><li><a href="http://www.cyberciti.biz/faq/ubuntu-network-restart/" class="crp_title">Ubuntu Restart Networking Command</a></li><li><a href="http://www.cyberciti.biz/faq/rhel-track-monitor-tcp-connections-on-network/" class="crp_title">Redhat Enterprise Linux 5 / CentOS 5 monitor and track TCP connections on…</a></li><li><a href="http://www.cyberciti.biz/faq/unix-network-service-restart-stop/" class="crp_title">Unix HowTo: Start / Stop / Restart Network Service Command</a></li><li><a href="http://www.cyberciti.biz/faq/ubuntu-restart-start-stop-networking-service-howto/" class="crp_title">Ubuntu Linux Restart Network Service</a></li><li><a href="http://www.cyberciti.biz/faq/centos-ssh/" class="crp_title">CentOS SSH Installation And Configuration</a></li><li><a href="http://www.cyberciti.biz/faq/linux-tcp-tuning/" class="crp_title">Linux Tune Network Stack (Buffers Size) To Increase Networking Performance</a></li><li><a href="http://www.cyberciti.biz/faq/linux-iptables-firewall-open-port-80/" class="crp_title">Linux Open Port 80 (HTTP Web Server Port)</a></li><li><a href="http://www.cyberciti.biz/faq/rhel-centos-linux-7-restart-networking-command-line/" class="crp_title">CentOS / RHEL 7 Restart / Stop / Start Networking Command</a></li><li><a href="http://www.cyberciti.biz/faq/samba-restrict-access-to-ipc-share/" class="crp_title">Samba Restrict IPC$ ( list of shared resources )</a></li></ul></div><div class="crp_clear"></div></div><p></p><center>  <ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="9863511468" data-ad-format="autorelaxed"></ins>  </center></div></div><div id="comments"><p class="comments_closed">Comments on this entry are closed.</p><ul class="comment_list"><li class="comment even thread-even depth-1" id="comment-86246"><div class="comment_head"> <span class="comment_author">Lyle</span> <span class="comment_date">April 10, 2013, 5:18 am</span></div><div class="comment_text grt" id="comment-body-86246"><p>As far as I know, there is no way (aside from modifying the source, constant TCP_TIMEWAIT_LEN) to modify the MSL nor the TCP TIME_WAIT</p><p>You may have luck with the time_wait bucket (reuse|recycle), but it becomes tricky if your upstream is stateful and doesn’t expect the same source-port so quickly (&lt;2*MSL)</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-86246" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-123115"><div class="comment_head"> <span class="comment_author">Carlos FernÃ¡ndez San MillÃ¡n</span> <span class="comment_date">March 10, 2014, 8:33 pm</span></div><div class="comment_text grt" id="comment-body-123115"><p>Hello!</p><p>I believe the examples have typos as the IPs do not correspond.</p><p>Best.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-123115" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment byuser comment-author-administrator bypostauthor even depth-2" id="comment-123144"><div class="comment_head"> <span class="comment_author"><a href="http://www.cyberciti.biz/tips/about-us" rel="external nofollow" class="url">Nix Craft</a></span> <span class="comment_date">March 10, 2014, 11:42 pm</span></div><div class="comment_text grt" id="comment-body-123144"><p>Thanks for the heads up!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-123144" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li></ul></div><div class="prev_next"><p class="next_post">Next FAQ: <a href="http://www.cyberciti.biz/faq/howto-linux-unix-bsd-appleosx-using-rsync-with-ftp-server/" rel="next">Linux / Unix: Use rsync Command Over FTP</a></p><p class="previous_post">Previous FAQ: <a href="http://www.cyberciti.biz/faq/suse-ubuntu-linux-start-stop-restart-apparmor-command/" rel="prev">Linux: Start / Stop / Restart Apparmor</a></p></div></div><div style="position: relative; overflow: visible; box-sizing: border-box; min-height: 1px;" class="sidebar"><div style="padding-top: 1px; padding-bottom: 1px; position: static;" class="theiaStickySidebar"><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget"><div id="bsap_1304534" class="bsarocks bsap_bccb43591680e039e32e874cbcc9e431"></div></div></div><div class="widget search-form" id="thesis-search-widget-3"><form class="search_form" method="get" action="http://www.cyberciti.biz/faq"><p> <input class="input_text" id="s" name="s" value="To search, type and hit enter" type="text"> <input id="searchsubmit" value="Search" type="hidden"></p></form></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget"><ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 600px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="3521177162"></ins> </div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><p class="widget_title">Featured Articles:</p><div class="textwidget"><ul><li><a href="http://www.cyberciti.biz/open-source/30-cool-best-open-source-softwares-of-2013/">30 Cool Open Source Software I Discovered in 2013</a></li><li><a href="http://www.cyberciti.biz/tips/bash-aliases-mac-centos-linux-unix.html">30 Handy Bash Shell Aliases For Linux / Unix / Mac OS X</a></li><li><a href="http://www.cyberciti.biz/networking/nmap-command-examples-tutorials/">Top 30 Nmap Command Examples For Sys/Network Admins</a></li><li><a href="http://www.cyberciti.biz/tips/php-security-best-practices-tutorial.html">25 PHP Security Best Practices For Sys Admins</a></li><li><a href="http://www.cyberciti.biz/tips/top-linux-monitoring-tools.html">20 Linux System Monitoring Tools Every SysAdmin Should Know</a></li><li><a href="http://www.cyberciti.biz/tips/linux-security.html">20 Linux Server Hardening Security Tips</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-examples.html">Linux: 20 Iptables Examples For New SysAdmins</a></li><li><a href="http://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html">Top 20 OpenSSH Server Best Security Practices </a></li><li><a href="http://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html">Top 20 Nginx WebServer Best Security Practices</a></li><li><a href="http://www.cyberciti.biz/tips/check-unix-linux-configuration-file-for-syntax-errors.html">20 Examples: Make Sure Unix / Linux Configuration Files Are Free From Syntax Errors</a></li><li><a href="http://www.cyberciti.biz/open-source/best-terminal-applications-for-linux-unix-macosx/">15 Greatest Open Source Terminal Applications Of 2012</a></li><li><a href="http://www.cyberciti.biz/tips/my-10-unix-command-line-mistakes.html">My 10 UNIX Command Line Mistakes</a></li><li><a href="http://www.cyberciti.biz/tips/open-source-project-management-software.html">Top 10 Open Source Web-Based Project Management Software</a></li><li><a href="http://www.cyberciti.biz/tips/download-email-client-for-linux-mac-osx-windows.html">Top 5 Email Client For Linux, Mac OS X, and Windows Users</a></li><li><a href="http://www.cyberciti.biz/tips/linux-laptop.html">The Novice Guide To Buying A Linux Laptop</a></li></ul></div></div><div class="extendedwopts-show extendedwopts-desktop extendedwopts-md-center widget widget_text" id=""><div class="textwidget">  <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 1057px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="6636490668"></ins> </div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><p class="widget_title">Don’t Miss Any Linux Tips</p><div class="textwidget"><form style="border: 1px solid rgb(204, 204, 204); padding: 3px; text-align: center;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow"><p>Get nixCraft in your inbox. It's free:</p><p><input value="Your email address" style="width: 140px;" name="email" type="text"></p><input value="Nixcraft-LinuxFreebsdSolarisTipsTricks" name="uri" type="hidden"><input name="loc" value="en_US" type="hidden"><input value="Subscribe" type="submit"></form></div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget"><center> <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="2272802261"></ins>  </center></div></div></div></div></div><div class="footer"> ©2000-2016 nixCraft. All rights reserved. <a href="http://www.cyberciti.biz/tips/privacy">Privacy</a> - <a href="http://www.cyberciti.biz/tips/disclaimer">Terms of Service</a> - <a href="http://www.cyberciti.biz/tips/contact-us">Questions or Comments</a></div></div><div data-theiastickysidebar-sidebarselector="&quot;#secondary, #sidebar, .sidebar, #primary&quot;" data-theiastickysidebar-options="{&quot;containerSelector&quot;:&quot;&quot;,&quot;additionalMarginTop&quot;:0,&quot;additionalMarginBottom&quot;:0,&quot;updateSidebarHeight&quot;:false,&quot;minWidth&quot;:0,&quot;sidebarBehavior&quot;:&quot;stick-to-bottom&quot;,&quot;disableOnResponsiveLayouts&quot;:true}"></div>







</body>
</html>
