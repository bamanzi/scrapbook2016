<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"> <title>Linux: 20 Iptables Examples For New SysAdmins</title><link rel="canonical" href="http://www.cyberciti.biz/tips/linux-iptables-examples.html"><link rel="alternate" type="application/rss+xml" title="nixCraft feed" href="http://www.cyberciti.biz/tips/feed"><link rel="pingback" href="http://www.cyberciti.biz/tips/xmlrpc.php"><link rel="dns-prefetch" href="http://s.w.org/"><link rel="alternate" type="application/rss+xml" title="nixCraft » Linux: 20 Iptables Examples For New SysAdmins Comments Feed" href="http://www.cyberciti.biz/tips/linux-iptables-examples.html/feed">   <link rel="https://api.w.org/" href="http://www.cyberciti.biz/tips/wp-json/"><link rel="alternate" type="application/json+oembed" href="http://www.cyberciti.biz/tips/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.cyberciti.biz%2Ftips%2Flinux-iptables-examples.html"><link rel="alternate" type="text/xml+oembed" href="http://www.cyberciti.biz/tips/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.cyberciti.biz%2Ftips%2Flinux-iptables-examples.html&amp;format=xml"><meta name="description" content="Iptables rules example for new Linux sys admin: Explains how to protect the server, display, set, modify, delete rules including blocking IP address and ports. "><link rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head><body class="template-single">  <div class="container"> <span class="menu_control">≡ Menu</span><ul id="menu-menu-1" class="menu"><li id="menu-item-113451" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113451"><a href="http://www.cyberciti.biz/">Home</a></li><li id="menu-item-113502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113502"><a href="http://www.cyberciti.biz/faq/">Howtos and Tutorials</a></li><li id="menu-item-113500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113500"><a href="https://bash.cyberciti.biz/guide/Main_Page">Linux Shell Scripting TutoriaL</a></li><li id="menu-item-113503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113503"><a href="http://www.cyberciti.biz/tips/about-us">About</a></li><li id="menu-item-113501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113501"><a href="http://www.cyberciti.biz/nixcraft-rss-feed-syndication/">RSS/Feed</a></li></ul><div id="header" class="header"><div id="site_title"><a href="http://www.cyberciti.biz/tips">nixCraft</a></div><div id="site_tagline">Linux Tips, Hacks, Tutorials, And Ideas In Blog Format</div></div><div class="columns"><div class="content"><div id="post-8353" class="post_box grt top" itemscope="" itemtype="http://schema.org/Article"><meta itemscope="" itemprop="mainEntityOfPage" itemtype="https://schema.org/WebPage" itemid="http://www.cyberciti.biz/tips/linux-iptables-examples.html"><div class="headline_area"><h1 class="headline" itemprop="headline">Linux: 20 Iptables Examples For New SysAdmins</h1><div class="byline small"> <span class="post_author_intro">by</span> <span class="post_author">Vivek Gite</span> <span class="post_date_intro">on</span> <span class="post_date" title="2011-12-13">December 13, 2011<span style="font-style: italic; text-transform: lowercase;"> last updated </span>January 21, 2016</span><div class="post_cats"> <span class="post_cats_intro">in</span> <a href="http://www.cyberciti.biz/tips/category/iptables" rel="category tag">Iptables</a>, <a href="http://www.cyberciti.biz/tips/category/linux" rel="category tag">Linux</a>, <a href="http://www.cyberciti.biz/tips/category/linux-distribution" rel="category tag">Linux distribution</a>, <a href="http://www.cyberciti.biz/tips/category/linux-embedded-devices" rel="category tag">Linux Embedded devices</a>, <a href="http://www.cyberciti.biz/tips/category/linux-laptop" rel="category tag">Linux laptop</a></div></div></div><div class="post_content"><div style="float: right; margin-top: 0px; margin-left: 5px;"><a href="http://www.cyberciti.biz/tips/category/iptables" title="See all Firewall related tips/articles"><img src="firewall.png" border="0"></a></div><p><span class="drop_cap">L</span>inux comes with a host based firewall called Netfilter. According to the official project site:</p><p></p><center>  <ins class="adsbygoogle" style="display: inline-block; width: 336px; height: 280px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="2404767461"></ins> <p></p></center><p></p><blockquote><p>netfilter is a set of hooks inside the Linux kernel that allows kernel modules to register callback functions with the network stack. A registered callback function is then called back for every packet that traverses the respective hook within the network stack.</p></blockquote><p>This Linux based firewall is controlled by the program called iptables to handles filtering for IPv4, and ip6tables handles filtering for IPv6. I strongly recommend that you first read our <a href="http://www.cyberciti.biz/faq/rhel-fedorta-linux-iptables-firewall-configuration-tutorial/">quick tutorial that explains how to configure a host-based firewall called Netfilter</a> (iptables) under CentOS / RHEL / Fedora / Redhat Enterprise Linux. This post lists most simple iptables solutions required by a new Linux user to secure his or her Linux operating system from intruders.<br> <span id="more-8353"></span></p><div style="float: right; margin-top: 0px; margin-left: 5px;"><a href="http://www.cyberciti.biz/tips/category/linux" title="See all GNU/Linux related tips/articles"><img src="linux-logo.png" border="0"></a></div><h2>IPTABLES Rules Example</h2><ul><li>Most of the actions listed in this post written with the assumption that they will be executed by the root user running the bash or any other modern shell. Do not type commands on the remote system as it will disconnect your access.</li><li>For demonstration purpose, I’ve used RHEL 6.x, but the following command should work with any modern Linux distro that use the netfliter.</li><li>It is NOT a tutorial on how to set iptables. See <a href="http://www.cyberciti.biz/faq/rhel-fedorta-linux-iptables-firewall-configuration-tutorial/">tutorial here</a>. It is a quick cheat sheet to common iptables commands.</li></ul><h2>#1: Displaying the Status of Your Firewall</h2><p>Type the following command as root:<br> <code># iptables -L -n -v</code><br> Sample outputs:</p><pre>Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
</pre><p>Above output indicates that the firewall is not active. The following sample shows an active firewall:<br> <code># iptables -L -n -v</code><br> Sample outputs:</p><pre>Chain INPUT (policy DROP 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           state INVALID
  394 43586 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED
   93 17292 ACCEPT     all  --  br0    *       0.0.0.0/0            0.0.0.0/0
    1   142 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0
Chain FORWARD (policy DROP 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ACCEPT     all  --  br0    br0     0.0.0.0/0            0.0.0.0/0
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           state INVALID
    0     0 TCPMSS     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp flags:0x06/0x02 TCPMSS clamp to PMTU
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED
    0     0 wanin      all  --  vlan2  *       0.0.0.0/0            0.0.0.0/0
    0     0 wanout     all  --  *      vlan2   0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  br0    *       0.0.0.0/0            0.0.0.0/0
Chain OUTPUT (policy ACCEPT 425 packets, 113K bytes)
 pkts bytes target     prot opt in     out     source               destination
Chain wanin (1 references)
 pkts bytes target     prot opt in     out     source               destination
Chain wanout (1 references)
 pkts bytes target     prot opt in     out     source               destination
</pre><p>Where,</p><ul><li><strong>-L</strong> : List rules.</li><li><strong>-v</strong> : Display detailed information. This option makes the list command show the interface name, the rule options, and the TOS masks.  The packet  and  byte  counters  are also listed, with the suffix ‘K’, ‘M’ or ‘G’ for 1000, 1,000,000 and 1,000,000,000 multipliers respectively.</li><li><strong>-n</strong> : Display IP address and port in numeric format. Do not use DNS to resolve names. This will speed up listing.</li></ul><h3>#1.1: To inspect firewall with line numbers, enter:</h3><p><code># iptables -n -L -v --line-numbers</code><br> Sample outputs:</p><pre>Chain INPUT (policy DROP)
num  target     prot opt source               destination
1    DROP       all  --  0.0.0.0/0            0.0.0.0/0           state INVALID
2    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED
3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0
4    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0
Chain FORWARD (policy DROP)
num  target     prot opt source               destination
1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0
2    DROP       all  --  0.0.0.0/0            0.0.0.0/0           state INVALID
3    TCPMSS     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp flags:0x06/0x02 TCPMSS clamp to PMTU
4    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED
5    wanin      all  --  0.0.0.0/0            0.0.0.0/0
6    wanout     all  --  0.0.0.0/0            0.0.0.0/0
7    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0
Chain OUTPUT (policy ACCEPT)
num  target     prot opt source               destination
Chain wanin (1 references)
num  target     prot opt source               destination
Chain wanout (1 references)
num  target     prot opt source               destination
</pre><p>You can use line numbers to delete or insert new rules into the firewall.</p><h3>#1.2: To display INPUT or OUTPUT chain rules, enter:</h3><p><code># iptables -L INPUT -n -v<br> # iptables -L OUTPUT -n -v --line-numbers</code></p><h2>#2: Stop / Start / Restart the Firewall</h2><p>If you are using CentOS / RHEL / Fedora Linux, enter:<br> <code># service iptables stop<br> # service iptables start<br> # service iptables restart</code><br> You can use the iptables command itself to stop the firewall and delete all rules:<br> <code># iptables -F<br> # iptables -X<br> # iptables -t nat -F<br> # iptables -t nat -X<br> # iptables -t mangle -F<br> # iptables -t mangle -X<br> # iptables -P INPUT ACCEPT<br> # iptables -P OUTPUT ACCEPT<br> # iptables -P FORWARD ACCEPT</code><br> Where,</p><ul><li><strong>-F</strong> : Deleting (flushing) all the rules.</li><li><strong>-X</strong> : Delete chain.</li><li><strong>-t table_name</strong> : Select table (called nat or mangle) and delete/flush rules.</li><li><strong>-P</strong> : Set the default policy (such as DROP, REJECT, or ACCEPT).</li></ul><h2>#3: Delete Firewall Rules</h2><p>To display line number along with other information for existing rules, enter:<br> <code># iptables -L INPUT -n --line-numbers<br> # iptables -L OUTPUT -n --line-numbers<br> # iptables -L OUTPUT -n --line-numbers | less<br> # iptables -L OUTPUT -n --line-numbers | grep 202.54.1.1</code><br> You will get the list of IP. Look at the number on the left, then use number to delete it. For example delete line number 4, enter:<br> <code># iptables -D INPUT 4</code><br> OR find source IP 202.54.1.1 and delete from rule:<br> <code># iptables -D INPUT -s 202.54.1.1 -j DROP</code><br> Where,</p><ul><li><strong>-D </strong>: Delete one or more rules from the selected chain</li></ul><h2>#4: Insert Firewall Rules</h2><p>To insert one or more rules in the selected chain as the given rule number use the following syntax. First find out line numbers, enter:<br> # iptables -L INPUT -n –line-numbers<br> Sample outputs:</p><pre>Chain INPUT (policy DROP)
num  target     prot opt source               destination
1    DROP       all  --  202.54.1.1           0.0.0.0/0
2    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state NEW,ESTABLISHED </pre><p>To insert rule between 1 and 2, enter:<br> <code># iptables -I INPUT 2 -s 202.54.1.2 -j DROP</code><br> To view updated rules, enter:<br> <code># iptables -L INPUT -n --line-numbers</code><br> Sample outputs:</p><pre>Chain INPUT (policy DROP)
num  target     prot opt source               destination
1    DROP       all  --  202.54.1.1           0.0.0.0/0
2    DROP       all  --  202.54.1.2           0.0.0.0/0
3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state NEW,ESTABLISHED</pre><h2>#5: Save Firewall Rules</h2><p>To save firewall rules under CentOS / RHEL / Fedora Linux, enter:<br> <code># service iptables save</code><br> In this example, drop an IP and save firewall rules:<br> <code># iptables -A INPUT -s 202.5.4.1 -j DROP<br> # service iptables save</code><br> For all other distros use the iptables-save command:<br> <code># iptables-save &gt; /root/my.active.firewall.rules<br> # cat /root/my.active.firewall.rules</code></p><h2>#6: Restore Firewall Rules</h2><p>To restore firewall rules form a file called /root/my.active.firewall.rules, enter:<br> <code># iptables-restore &lt; /root/my.active.firewall.rules</code><br> To restore firewall rules under CentOS / RHEL / Fedora Linux, enter:<br> <code># service iptables restart</code></p><h2>#7: Set the Default Firewall Policies</h2><p>To drop all traffic:<br> <code># iptables -P INPUT DROP<br> # iptables -P OUTPUT DROP<br> # iptables -P FORWARD DROP<br> # iptables -L -v -n<br> #### you will not able to connect anywhere as all traffic is dropped ###<br> # ping cyberciti.biz<br> # wget http://www.kernel.org/pub/linux/kernel/v3.0/testing/linux-3.2-rc5.tar.bz2</code></p><h3>#7.1: Only Block Incoming Traffic</h3><p>To drop all incoming / forwarded packets, but allow outgoing traffic, enter:<br> <code># iptables -P INPUT DROP<br> # iptables -P FORWARD DROP<br> # iptables -P OUTPUT ACCEPT<br> # iptables -A INPUT -m state --state NEW,ESTABLISHED -j ACCEPT<br> # iptables -L -v -n<br> ### *** now ping and wget should work *** ###<br> # ping cyberciti.biz<br> # wget http://www.kernel.org/pub/linux/kernel/v3.0/testing/linux-3.2-rc5.tar.bz2</code></p><h2>#8:Drop Private Network Address On Public Interface</h2><p>IP spoofing is nothing but to stop the following IPv4 address ranges for private networks on your public interfaces. Packets with non-routable source addresses should be rejected using the following syntax:<br> <code># iptables -A INPUT -i eth1 -s 192.168.0.0/24 -j DROP<br> # iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j DROP</code></p><h3>#8.1: IPv4 Address Ranges For Private Networks (make sure you block them on public interface)</h3><ul><li>10.0.0.0/8 -j (A)</li><li>172.16.0.0/12 (B)</li><li>192.168.0.0/16 (C)</li><li>224.0.0.0/4 (MULTICAST D)</li><li>240.0.0.0/5 (E)</li><li>127.0.0.0/8 (LOOPBACK)</li></ul><h2>#9: Blocking an IP Address (BLOCK IP)</h2><p>To block an attackers ip address called 1.2.3.4, enter:<br> <code># iptables -A INPUT -s 1.2.3.4 -j DROP<br> # iptables -A INPUT -s 192.168.0.0/24 -j DROP</code></p><h2>#10: Block Incoming Port Requests (BLOCK PORT)</h2><p>To block all service requests on port 80, enter:<br> <code># iptables -A INPUT -p tcp --dport 80 -j DROP<br> # iptables -A INPUT -i eth1 -p tcp --dport 80 -j DROP</code></p><p>To block port 80 only for an ip address 1.2.3.4, enter:<br> <code># iptables -A INPUT -p tcp -s 1.2.3.4 --dport 80 -j DROP<br> # iptables -A INPUT -i eth1 -p tcp -s 192.168.1.0/24 --dport 80 -j DROP</code></p><h2>#11: Block Outgoing IP Address</h2><p>To block outgoing traffic to a particular host or domain such as cyberciti.biz, enter:<br> <code># host -t a cyberciti.biz</code><br> Sample outputs:</p><pre>cyberciti.biz has address 75.126.153.206</pre><p>Note down its ip address and type the following to block all outgoing traffic to 75.126.153.206:<br> <code># iptables -A OUTPUT -d 75.126.153.206 -j DROP</code><br> You can use a subnet as follows:<br> <code># iptables -A OUTPUT -d 192.168.1.0/24 -j DROP<br> # iptables -A OUTPUT -o eth1 -d 192.168.1.0/24 -j DROP</code></p><h3>#11.1: Example - Block Facebook.com Domain</h3><p>First, find out all ip address of facebook.com, enter:<br> <code># host -t a www.facebook.com</code><br> Sample outputs:</p><pre>www.facebook.com has address 69.171.228.40</pre><p>Find CIDR for 69.171.228.40, enter:<br> <code># whois 69.171.228.40 | grep CIDR</code><br> Sample outputs:</p><pre>CIDR:           69.171.224.0/19</pre><p>To prevent outgoing access to www.facebook.com, enter:<br> <code># iptables -A OUTPUT -p tcp -d 69.171.224.0/19 -j DROP</code><br> You can also use domain name, enter:<br> <code># iptables -A OUTPUT -p tcp -d www.facebook.com -j DROP<br> # iptables -A OUTPUT -p tcp -d facebook.com -j DROP</code></p><p>From the iptables man page:</p><blockquote><p>... specifying any name to be resolved with a remote query such as DNS (e.g., facebook.com is a really bad idea), a network IP address (with /mask),  or  a  plain  IP address ...</p></blockquote><h2>#12: Log and Drop Packets</h2><p>Type the following to log and block IP spoofing on public interface called eth1<br> <code># iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j LOG --log-prefix "IP_SPOOF A: "<br> # iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j DROP</code><br> By default everything is logged to /var/log/messages file.<br> <code># tail -f /var/log/messages<br> # grep --color  'IP SPOOF' /var/log/messages</code></p><h2>#13: Log and Drop Packets with Limited Number of Log Entries</h2><p>The -m limit module can limit the number of log entries created per time. This is used to prevent flooding your log file. To log and drop spoofing per 5 minutes, in bursts of at most 7 entries .<br> <code># iptables -A INPUT -i eth1 -s 10.0.0.0/8 -m limit --limit 5/m --limit-burst 7 -j LOG --log-prefix "IP_SPOOF A: "<br> # iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j DROP</code></p><h2>#14: Drop or Accept Traffic From Mac Address</h2><p>Use the following syntax:<br> <code># iptables -A INPUT -m mac --mac-source 00:0F:EA:91:04:08 -j DROP<br> ## *only accept traffic for TCP port # 8080 from mac 00:0F:EA:91:04:07 * ##<br> # iptables -A INPUT -p tcp --destination-port 22 -m mac --mac-source 00:0F:EA:91:04:07 -j ACCEPT</code></p><h2>#15: Block or Allow ICMP Ping Request</h2><p>Type the following command to block ICMP ping requests:<br> <code># iptables -A INPUT -p icmp --icmp-type echo-request -j DROP<br> # iptables -A INPUT -i eth1 -p icmp --icmp-type echo-request -j DROP</code><br> Ping responses can also be limited to certain networks or hosts:<br> <code># iptables -A INPUT -s 192.168.1.0/24 -p icmp --icmp-type echo-request -j ACCEPT</code><br> The following only accepts limited type of ICMP requests:<br> <code>### ** assumed that default INPUT policy set to DROP ** #############<br> iptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT<br> iptables -A INPUT -p icmp --icmp-type destination-unreachable -j ACCEPT<br> iptables -A INPUT -p icmp --icmp-type time-exceeded -j ACCEPT<br> ## ** all our server to respond to pings ** ##<br> iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT</code></p><h2>#16: Open Range of Ports</h2><p>Use the following syntax to open a range of ports:<br> <code>iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 7000:7010 -j ACCEPT </code></p><h2>#17: Open Range of IP Addresses</h2><p>Use the following syntax to open a range of IP address:<br> <code> ## only accept connection to tcp port 80 (Apache) if ip is between 192.168.1.100 and 192.168.1.200 ##<br> iptables -A INPUT -p tcp --destination-port 80 -m iprange --src-range 192.168.1.100-192.168.1.200 -j ACCEPT</code></p><p><code>## nat example ##<br> iptables -t nat -A POSTROUTING -j SNAT --to-source 192.168.1.20-192.168.1.25<br> </code></p><h2>#18: Established Connections and Restaring The Firewall</h2><p>When you restart the iptables service it will drop established connections as it unload modules from the system under RHEL / Fedora / CentOS Linux. Edit, /etc/sysconfig/iptables-config and set IPTABLES_MODULES_UNLOAD as follows:</p><pre>IPTABLES_MODULES_UNLOAD = no</pre><h2>#19: Help Iptables Flooding My Server Screen</h2><p>Use the crit log level to send messages to a log file instead of console:<br> <code>iptables -A INPUT -s 1.2.3.4 -p tcp --destination-port 80 -j LOG --log-level crit</code></p><h2>#20: Block or Open Common Ports</h2><p>The following shows syntax for opening and closing common TCP and UDP ports:</p><div class="wp_syntax"><table><tbody><tr><td class="code"><pre class="bash" style="font-family: monospace;">Replace ACCEPT with DROP to block port:
<span style="color: rgb(102, 102, 102); font-style: italic;">## open port ssh tcp port 22 ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-m</span> tcp <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">22</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">22</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open cups (printing service) udp/tcp port 631 for LAN users ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-p</span> udp <span style="color: rgb(102, 0, 51);">-m</span> udp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">631</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">-m</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">631</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## allow time sync via NTP for lan users (open udp port 123) ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> udp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">123</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open tcp port 25 (smtp) for all ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">25</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;"># open dns server ports for all ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> udp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">53</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">53</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open http/https (Apache) server port to all ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">80</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">443</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open tcp port 110 (pop3) for all ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">110</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open tcp port 143 (imap) for all ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">143</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open access to Samba file server for lan users only ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">137</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">138</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">139</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">445</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open access to proxy server for lan users only ##</span>
iptables <span style="color: rgb(102, 0, 51);">-A</span> INPUT <span style="color: rgb(102, 0, 51);">-s</span> 192.168.1.0<span style="color: rgb(0, 0, 0); font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">24</span> <span style="color: rgb(102, 0, 51);">-m</span> state <span style="color: rgb(102, 0, 51);">--state</span> NEW <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">3128</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT
&nbsp;
<span style="color: rgb(102, 102, 102); font-style: italic;">## open access to mysql server for lan users only ##</span>
iptables <span style="color: rgb(102, 0, 51);">-I</span> INPUT <span style="color: rgb(102, 0, 51);">-p</span> tcp <span style="color: rgb(102, 0, 51);">--dport</span> <span style="color: rgb(0, 0, 0);">3306</span> <span style="color: rgb(102, 0, 51);">-j</span> ACCEPT</pre></td></tr></tbody></table></div><h2>#21: Restrict the Number of Parallel Connections To a Server Per Client IP</h2><p>You can use connlimit module to put such restrictions. To allow 3 ssh connections per client host, enter:<br> <code># iptables -A INPUT -p tcp --syn --dport 22 -m connlimit --connlimit-above 3 -j REJECT</code></p><p>Set HTTP requests to 20:<br> <code># iptables -p tcp --syn --dport 80 -m connlimit --connlimit-above 20 --connlimit-mask 24 -j DROP</code><br> Where,</p><ol><li><strong>--connlimit-above 3</strong> : Match if the number of existing connections is above 3.</li><li><strong>--connlimit-mask 24</strong> : Group hosts using the prefix length. For IPv4, this must be a number between (including) 0 and 32.</li></ol><h2>#22: HowTO: Use iptables Like a Pro</h2><p>For more information about iptables, please see the manual page by typing man iptables from the command line:<br> <code>$ man iptables</code><br> You can see the help using the following syntax too:<br> <code># iptables -h</code><br> To see help with specific commands and targets, enter:<br> <code># iptables -j DROP -h</code></p><h3>#22.1: Testing Your Firewall</h3><p>Find out if ports are open or not, enter:<br> <code># netstat -tulpn</code><br> Find out if tcp port 80 open or not, enter:<br> <code># netstat -tulpn | grep :80</code><br> If port 80 is not open, start the Apache, enter:<br> <code># service httpd start</code><br> Make sure iptables allowing access to the port 80:<br> <code># iptables -L INPUT -v -n | grep 80</code><br> Otherwise open port 80 using the iptables for all users:<br> <code># iptables -A INPUT -m state --state NEW -p tcp --dport 80 -j ACCEPT<br> # service iptables save</code><br> Use the telnet command to see if firewall allows to connect to port 80:<br> <code>$ telnet www.cyberciti.biz 80</code><br> Sample outputs:</p><pre>Trying 75.126.153.206...
Connected to www.cyberciti.biz.
Escape character is '^]'.
^]
telnet&gt; quit
Connection closed.
</pre><p>You can use nmap to probe your own server using the following syntax:<br> <code>$ nmap -sS -p 80 www.cyberciti.biz</code><br> Sample outputs:</p><pre>Starting Nmap 5.00 ( http://nmap.org ) at 2011-12-13 13:19 IST
Interesting ports on www.cyberciti.biz (75.126.153.206):
PORT   STATE SERVICE
80/tcp open  http
Nmap done: 1 IP address (1 host up) scanned in 1.00 seconds
</pre><p>I also recommend you install and use sniffer such as tcpdupm and ngrep to test your firewall settings.</p><h4>Conclusion:</h4><p>This post only list basic rules for new Linux users. You can create and build more complex rules. This requires good understanding of TCP/IP, Linux kernel tuning via sysctl.conf, and good knowledge of your own setup. Stay tuned for next topics:</p><ul><li>Stateful packet inspection.</li><li>Using connection tracking helpers.</li><li>Network address translation.</li><li>Layer 2 filtering.</li><li>Firewall testing tools.</li><li>Dealing with VPNs, DNS, Web, Proxy, and other protocols.</li></ul> <strong>Share this on:</strong><br><div class="nixcraft-social"><a class="nixcraft-link nixcraft-twitter" href="https://twitter.com/intent/tweet?text=Linux%3A+20+Iptables+Examples+For+New+SysAdmins&amp;url=http://www.cyberciti.biz/tips/linux-iptables-examples.html&amp;via=nixcraft" title="Tweet this tutorial/page">Twitter</a><a class="nixcraft-link nixcraft-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.cyberciti.biz/tips/linux-iptables-examples.html" title="Share this page/tutorial on Fa
cebook">Facebook</a><a class="nixcraft-link nixcraft-googleplus" href="https://plus.google.com/share?url=http://www.cyberciti.biz/tips/linux-iptables-examples.html" title="Share this page/tutorial on Google+">Google+</a><a a=""></a><a class="nixcraft-link nixcraft-pdf" href="http://www.cyberciti.biz/view/pdf/tips/8353.php" title="Download this blog post as a free pdf">Download PDF version </a><a class="nixcraft-link nixcraft-error" href="https://nixcraft.wufoo.com/forms/give-us-feedback-for-nixcraft/def/Field209=http://www.cyberciti.biz/tips/linux-iptables-examples.html&amp;Field211=Linux:%2020%20Iptables%20Examples%20For%20New%20SysAdmins" target="_blank" title="Click here to report Typo/Grammar and other Incorrect information">Found an error/typo on this page?</a></div><div class="crp_related "><div class="my_tutorial_series">About the author: Vivek Gite is a seasoned sysadmin and a trainer for the Linux/Unix &amp; shell scripting. Follow him on <strong><a href="https://twitter.com/nixcraft" style="text-decoration: underline;">Twitter</a></strong>. OR <strong>read more like this</strong>:<ul><li><a href="http://www.cyberciti.biz/tips/linux-iptables-4-block-all-incoming-traffic-but-allow-ssh.html" class="crp_title">Linux Iptables: Block All Incoming Traffic But Allow SSH</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-9-allow-icmp-ping.html" class="crp_title">Linux Iptables allow or block ICMP ping request</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-11-how-to-block-or-open-httpweb-service.html" class="crp_title">Linux Iptables: HowTo Block or Open HTTP/Web Service Port 80 &amp; 443</a></li><li><a href="http://www.cyberciti.biz/tips/how-do-i-build-a-simple-linux-firewall-for-dsldial-up-connection.html" class="crp_title">How do I build a Simple Linux Firewall for DSL/Dial-up connection?</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-how-to-specify-a-range-of-ip-addresses-or-ports.html" class="crp_title">Linux Iptables: How to specify a range of IP addresses or ports</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-12-how-to-block-or-open-dnsbind-service-port-53.html" class="crp_title">Linux Iptables block or open DNS / bind service port 53</a></li><li><a href="http://www.cyberciti.biz/tips/howto-limit-linux-syn-attacks.html" class="crp_title">Linux Iptables Limit the number of incoming tcp connection / syn-flood…</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-15-how-to-block-or-open-mail-serversmtp-protocol.html" class="crp_title">Linux Iptables: How to block or open mail server / SMTP protocol</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-open-bittorrent-tcp-ports-6881-to-6889.html" class="crp_title">Linux Iptables open Bittorrent tcp ports 6881 to 6889</a></li><li><a href="http://www.cyberciti.biz/tips/linux-iptables-16-how-to-allow-secure-mail-smtps.html" class="crp_title">Linux: Iptables # 16 How to allow secure mail SMTPS?</a></li></ul></div><div class="crp_clear"></div></div></div></div><div id="comments"><p class="comments_closed">Comments on this entry are closed.</p><ul class="comment_list"><li class="comment even thread-even depth-1" id="comment-176910"><div class="comment_head"> <span class="comment_author"><a href="http://www.happysysadm.com/" rel="external nofollow" class="url">Happysysadm</a></span> <span class="comment_date">December 13, 2011, 10:10 am</span></div><div class="comment_text grt" id="comment-body-176910"><p>This is a nice breakdown of IPTABLES indeed! Thank you for taking the time for such a comprehensive explaination… I shall bookmark this!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176910" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-176919"><div class="comment_head"> <span class="comment_author"><a href="http://www.thierry-jaouen.fr/logicos" rel="external nofollow" class="url">logicos</a></span> <span class="comment_date">December 13, 2011, 11:56 am</span></div><div class="comment_text grt" id="comment-body-176919"><p>Try ferm, “for Easy Rule Making” .</p><p>In file like “ferm.conf” :</p><p>chain ( INPUT OUTPUT FORWARD ) policy DROP;<br> chain INPUT proto tcp dport ssh ACCEPT;</p><p>And next:<br> ferm -i ferm.conf</p><p>Source: <a href="http://ferm.foo-projects.org/" rel="nofollow">http://ferm.foo-projects.org/</a></p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176919" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-176925"><div class="comment_head"> <span class="comment_author">LeftMeAlone</span> <span class="comment_date">December 13, 2011, 1:58 pm</span></div><div class="comment_text grt" id="comment-body-176925"><p>Can any one tell me the difference between the DROP vs REJECT? Which one is recommended for my mail server?</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176925" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment odd alt depth-2" id="comment-176929"><div class="comment_head"> <span class="comment_author">Worked</span> <span class="comment_date">December 13, 2011, 2:59 pm</span></div><div class="comment_text grt" id="comment-body-176929"><p>LeftMeAlone, “drop” does not send anything to the remote socket while “reject” sending the following message to the remote socket: (icmp destination port unrechable).</p><p> Make clean… “drop” maybe the service does not exists. “reject” you can not access to the service.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176929" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-176930"><div class="comment_head"> <span class="comment_author">Joeman1</span> <span class="comment_date">December 13, 2011, 3:07 pm</span></div><div class="comment_text grt" id="comment-body-176930"><p>@LeftMeAlone</p><p>DROP will silently drop a packet, not notifying the remote host of any problems, just won’t be available. This way, they will no know if the port is active and prohibited or just not used.</p><p>REJECT will send an ICMP packet back to the remote host explaining (For the lack of better words) that the host is administratively denied.</p><p>The former is preferred as a remote host will not be able to determine if the port is even up.</p><p>The latter is not recommended unless software requires the ICMP message for what ever reason. Its not recommended because the remote host will know that the port is in use, but will not be able to connect to it. This way, they can still try to hack the port and get into the system,</p><p>Hope this helps!<br> Joe</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176930" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-176933"><div class="comment_head"> <span class="comment_author">Prabal Mishra</span> <span class="comment_date">December 13, 2011, 3:36 pm</span></div><div class="comment_text grt" id="comment-body-176933"><p>thanks !</p><p>help for Iptables…………..</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176933" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-176935"><div class="comment_head"> <span class="comment_author">smilyface</span> <span class="comment_date">December 13, 2011, 4:11 pm</span></div><div class="comment_text grt" id="comment-body-176935"><p>Thankssss..</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176935" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-176941"><div class="comment_head"> <span class="comment_author">noone</span> <span class="comment_date">December 13, 2011, 7:28 pm</span></div><div class="comment_text grt" id="comment-body-176941"><p>how about you try<br> host -t a <a href="http://www.facebook.com/" rel="nofollow">http://www.facebook.com</a><br> a few times, just to see how dns round-rbin works…</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176941" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-176942"><div class="comment_head"> <span class="comment_author">noone</span> <span class="comment_date">December 13, 2011, 7:37 pm</span></div><div class="comment_text grt" id="comment-body-176942"><p>also, you can try this</p><pre>#!/bin/bash
# Clear any previous rules.
/sbin/iptables -F
# Default drop policy.
/sbin/iptables -P INPUT DROP
/sbin/iptables -P OUTPUT ACCEPT
# Allow anything over loopback and vpn.
/sbin/iptables -A INPUT -i lo -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT
/sbin/iptables -A OUTPUT -o lo -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT
/sbin/iptables -A INPUT -i tun0 -j ACCEPT
/sbin/iptables -A OUTPUT -o tun0 -j ACCEPT
/sbin/iptables -A INPUT -p esp -j ACCEPT
/sbin/iptables -A OUTPUT -p esp -j ACCEPT
# Drop any tcp packet that does not start a connection with a syn flag.
/sbin/iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP
# Drop any invalid packet that could not be identified.
/sbin/iptables -A INPUT -m state --state INVALID -j DROP
# Drop invalid packets.
/sbin/iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,FIN SYN,FIN              -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST              -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,RST FIN,RST              -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --tcp-flags ACK,FIN FIN                  -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --tcp-flags ACK,URG URG                  -j DROP
# Reject broadcasts to 224.0.0.1
/sbin/iptables -A INPUT -s 224.0.0.0/4 -j DROP
/sbin/iptables -A INPUT -d 224.0.0.0/4 -j DROP
/sbin/iptables -A INPUT -s 240.0.0.0/5 -j DROP
# Blocked ports
/sbin/iptables -A INPUT -p tcp -m state --state NEW,ESTABLISHED,RELATED --dport 8010 -j DROP
# Allow TCP/UDP connections out. Keep state so conns out are allowed back in.
/sbin/iptables -A INPUT  -p tcp -m state --state ESTABLISHED     -j ACCEPT
/sbin/iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT
/sbin/iptables -A INPUT  -p udp -m state --state ESTABLISHED     -j ACCEPT
/sbin/iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT
# Allow only ICMP echo requests (ping) in. Limit rate in. Uncomment if needed.
/sbin/iptables -A INPUT  -p icmp -m state --state NEW,ESTABLISHED --icmp-type echo-reply -j ACCEPT
/sbin/iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED --icmp-type echo-request -j ACCEPT
# or block ICMP allow only ping out
/sbin/iptables -A INPUT  -p icmp -m state --state NEW -j DROP
/sbin/iptables -A INPUT  -p icmp -m state --state ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT
# Allow ssh connections in.
#/sbin/iptables -A INPUT -p tcp -s 1.2.3.4 -m tcp --dport 22 -m state --state NEW,ESTABLISHED,RELATED -m limit --limit 2/m -j ACCEPT
# Drop everything that did not match above or drop and log it.
#/sbin/iptables -A INPUT   -j LOG --log-level 4 --log-prefix "IPTABLES_INPUT: "
/sbin/iptables -A INPUT   -j DROP
#/sbin/iptables -A FORWARD -j LOG --log-level 4 --log-prefix "IPTABLES_FORWARD: "
/sbin/iptables -A FORWARD -j DROP
#/sbin/iptables -A OUTPUT  -j LOG --log-level 4 --log-prefix "IPTABLES_OUTPUT: "
/sbin/iptables -A OUTPUT  -j ACCEPT
iptables-save &gt; /dev/null 2&gt;&amp;1
</pre></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176942" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-176944"><div class="comment_head"> <span class="comment_author">Coolm@x</span> <span class="comment_date">December 13, 2011, 7:38 pm</span></div><div class="comment_text grt" id="comment-body-176944"><p>Nice examples, but missing one. Commonly searched rule is one for masquerade.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176944" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-176952"><div class="comment_head"> <span class="comment_author"><a href="http://tsmt.eu/" rel="external nofollow" class="url">Roy</a></span> <span class="comment_date">December 13, 2011, 10:19 pm</span></div><div class="comment_text grt" id="comment-body-176952"><p>This is extremely useful, somekind of magic and quick recipe…<br> (Of course now i can’t send mail on my remote server (to strict rate limit …))</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176952" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-176963"><div class="comment_head"> <span class="comment_author">3y3lop</span> <span class="comment_date">December 14, 2011, 3:00 am</span></div><div class="comment_text grt" id="comment-body-176963"><p>Nice examples &amp; thanks.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-176963" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-177051"><div class="comment_head"> <span class="comment_author">Jani</span> <span class="comment_date">December 15, 2011, 9:00 am</span></div><div class="comment_text grt" id="comment-body-177051"><p>.. I’m anxiously awaiting similar translated to ip6tables. :-)</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177051" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-177327"><div class="comment_head"> <span class="comment_author"><a href="http://www.arrlwtx.org/" rel="external nofollow" class="url">Howard</a></span> <span class="comment_date">December 22, 2011, 3:24 am</span></div><div class="comment_text grt" id="comment-body-177327"><p>A most excellent presentation of iptables setup and use. Really Superior work. Thanks kindly.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177327" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-177375"><div class="comment_head"> <span class="comment_author"><a href="http://markas-al-nour.org/" rel="external nofollow" class="url">Linus Gasser</a></span> <span class="comment_date">December 22, 2011, 7:32 pm</span></div><div class="comment_text grt" id="comment-body-177375"><p>Point 8:</p><p>And for the private address ranges to block on public interfaces, you’ll also want to block</p><p>169.254/16 – zeroconf</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177375" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-177422"><div class="comment_head"> <span class="comment_author">Pieter</span> <span class="comment_date">December 23, 2011, 5:44 pm</span></div><div class="comment_text grt" id="comment-body-177422"><p>Nice post, thanks! In example #19 there is an error in the last line:</p><pre>## open access to mysql server for lan users only ##
iptables -I INPUT -p tcp --dport 3306 -j ACCEPT
</pre><p>Should probably be:</p><pre>## open access to mysql server for lan users only ##
iptables -I INPUT -p tcp -s 192.168.1.0/24 --dport 3306 -j ACCEPT
</pre></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177422" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment even depth-2" id="comment-179223"><div class="comment_head"> <span class="comment_author">shawn cao</span> <span class="comment_date">February 24, 2012, 4:33 am</span></div><div class="comment_text grt" id="comment-body-179223"><p>that is right.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-179223" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-177436"><div class="comment_head"> <span class="comment_author"><a href="http://www.elbauldelprogramador.com/" rel="external nofollow" class="url">Alejandro</a></span> <span class="comment_date">December 23, 2011, 11:15 pm</span></div><div class="comment_text grt" id="comment-body-177436"><p>Thanks for this post, I hope you don’t mind if I translate this to spanish and post it on my blog, Mentioning the original source, of course.</p><p>Regards</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177436" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-177437"><div class="comment_head"> <span class="comment_author">strangr</span> <span class="comment_date">December 24, 2011, 12:41 am</span></div><div class="comment_text grt" id="comment-body-177437"><p>Simple rules to share your connection to internet (interface IFNAME) with other hosts on your local LAN (NATTED_SUBNET).<br> In other words how to do NAT and MASQEURADEing.</p><pre>IFNAME=ppp0
NATTED_SUBNET=192.168.2.0/24</pre><p># 1) load appropriate kernel module</p><pre>modprobe iptable_nat</pre><p># 2) make sure IPv4 forwarding is enabled</p><pre>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</pre><p># 3) the appropriate rules</p><pre>iptables -A POSTROUTING -t nat -o $IFNAME -s $NATTED_SUBNET -d 0/0 \
         -j MASQUERADE
iptables -A FORWARD -t filter -o $IFNAME -s $NATTED_SUBNET -m state \
        --state NEW,ESTABLISHED,RELATED -j ACCEPT
iptables -A FORWARD -t filter -i $IFNAME -d $NATTED_SUBNET -m state \
        --state ESTABLISHED,RELATED -j ACCEPT
</pre></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177437" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment odd alt depth-2" id="comment-191934"><div class="comment_head"> <span class="comment_author">liRONux</span> <span class="comment_date">July 8, 2013, 12:50 pm</span></div><div class="comment_text grt" id="comment-body-191934"><p>THANKS for this.<br> How about blocking a website while having those rules?</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-191934" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-177775"><div class="comment_head"> <span class="comment_author">JD</span> <span class="comment_date">December 31, 2011, 2:27 am</span></div><div class="comment_text grt" id="comment-body-177775"><p>## open access to mysql server for lan users only ##<br> iptables -I INPUT -p tcp -s 192.168.1.0/24 –dport 3306 -j ACCEPT</p><p>This should be like this:</p><p>-s 192.168.1.0/24 -d 192.168.2.2 -i eth0 -p tcp -m state –state NEW -m tcp –dport 3306 -j ACCEPT</p><p>a rule like this should go under RELATED,ESTABLISHED in the INPUT chain</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177775" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-177777"><div class="comment_head"> <span class="comment_author">JD</span> <span class="comment_date">December 31, 2011, 2:39 am</span></div><div class="comment_text grt" id="comment-body-177777"><p>For email servers, I have rate limiting rules in place for all service ports.</p><p>In the INPUT chain I have the spam firewall ip(s), allowed via port 25.</p><p>Then for the email ports, I impose a hit count of 10 in 60 seconds, smart phones, email clients do not poll every second. Anything more than this is dropped and they can continue on a rampage with no affect on the server(s). It took me a while to come up with the rate-limiting chains to work with the email server. Since the Watch Guard XCS devices needed to be exempt from the rules. They have rate-limits on incoming connections as well, a lot better than Barracuda.</p><p>I always specify the source/destination interface, state then the port.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177777" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment even depth-2" id="comment-177919"><div class="comment_head"> <span class="comment_author">MB</span> <span class="comment_date">January 3, 2012, 8:17 am</span></div><div class="comment_text grt" id="comment-body-177919"><p>How do i open the port 25 on a public ip (eg. 1.2.3.4) because it is close, I can only send email but can’t receive email?<br> But on my localhost it’s open, when I test I able to send and receive only on 127.0.0.1. This is my rule</p><p>iptables -A INPUT -p tcp -m tcp –dport 25 -j ACCEPT</p><p>when i check netstat -tulpn | grep :25<br> tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      2671/exim4<br> tcp6       0      0 ::1:25                  :::*                    LISTEN      2671/exim4</p><p>Hope you can help me on this matter. I really confused on this one.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177919" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-177894"><div class="comment_head"> <span class="comment_author"><a href="http://www.bcbcd.org/" rel="external nofollow" class="url">Badr Najah</a></span> <span class="comment_date">January 2, 2012, 6:55 pm</span></div><div class="comment_text grt" id="comment-body-177894"><p>Very useful.<br> Thanks</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-177894" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-178028"><div class="comment_head"> <span class="comment_author">dilip</span> <span class="comment_date">January 5, 2012, 7:36 am</span></div><div class="comment_text grt" id="comment-body-178028"><p>Wooooooooooowwwwww. thats coooool…<br> very usefull link….</p><p>Thanks yar….</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-178028" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-178254"><div class="comment_head"> <span class="comment_author">nbasileu</span> <span class="comment_date">January 9, 2012, 10:19 am</span></div><div class="comment_text grt" id="comment-body-178254"><p>Rule #14</p><p>## *only accept traffic for TCP port # 8080 from mac 00:0F:EA:91:04:07 * ##<br> # iptables -A INPUT -p tcp –destination-port 22 -m mac –mac-source 00:0F:EA:91:04:07 -j ACCEPT</p><p>–destination-port 8080 not 22</p><p>Anyway, this is a fu**** good website with fully nice articles.<br> Very big thx dudes.</p><p>Happy new year everyone.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-178254" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-179415"><div class="comment_head"> <span class="comment_author">Atul Modi</span> <span class="comment_date">March 11, 2012, 10:16 am</span></div><div class="comment_text grt" id="comment-body-179415"><p>Excellent Stuff Guys!!!</p><p>Everyone is putting their part. Great to see this kind of community flourish further.</p><p>I am thankful to the ppl who started this website.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-179415" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-179437"><div class="comment_head"> <span class="comment_author">Daniel Vieceli</span> <span class="comment_date">March 13, 2012, 2:38 pm</span></div><div class="comment_text grt" id="comment-body-179437"><p>Excellent thanks.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-179437" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-179659"><div class="comment_head"> <span class="comment_author"><a href="http://n/a" rel="external nofollow" class="url">jm</a></span> <span class="comment_date">April 1, 2012, 3:48 am</span></div><div class="comment_text grt" id="comment-body-179659"><p>Good info and well written.Easy to understand for everyone… I will be back to learn more needed security rules.. Oh and yes I’m a human but I hate to say the definition of human is ( MONSTER) don’t believe me ? Look it up on the net ! Ha ha ha ha<br> Thank you for this page….</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-179659" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-179699"><div class="comment_head"> <span class="comment_author">rw1</span> <span class="comment_date">April 5, 2012, 7:45 am</span></div><div class="comment_text grt" id="comment-body-179699"><p>thank you! for the information on how to delete a firewall rule! priceless! thanks!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-179699" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-180223"><div class="comment_head"> <span class="comment_author">Eli</span> <span class="comment_date">May 11, 2012, 12:19 am</span></div><div class="comment_text grt" id="comment-body-180223"><p>How can i use iptable rules to use multiple internet connections for the same bit torrent download?<br> Actually, i have two broadband connections. I want to combine them. I am told to get load balancing hardware and i cant afford that. So, i did some experimenting. On first DSL modem, i set its IP to be 192.168.1.1<br> On second modem, i set its IP to be 192.168.2.1<br> Then in windows network adapter settings, i set Metric value of each adapter to 1. Thats about it. My bit torrent downloads/uploads use both my internet connections at the same time which gives effect of combined speed.<br> Can i do something like that in Linux?<br> Or, how can i combine two internet connections by using iptables? I dont want any hardware changes. All i have is two DSL modems and two network interface cards. Precise help would be greatly appreciated.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180223" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-180254"><div class="comment_head"> <span class="comment_author">kolya</span> <span class="comment_date">May 13, 2012, 6:55 pm</span></div><div class="comment_text grt" id="comment-body-180254"><p>Hi, got a question to the author of the article. I have tried different kind of commands from the command line, edited the file /etc/sysconfig/iptables directly with following saving and restarting iptables/rebooting system. Nothing helps, my rules get overwritten by the system flushing my new rules or editing them. I tried to open ports (22,21 etc). The goal why I edit my firewall is to get connected to ftp server via FileZilla. Would you recommend me  how to open ports? Tell me please if you need any system outputs or something. Cheers</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180254" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment byuser comment-author-administrator bypostauthor even thread-even depth-1" id="comment-180256"><div class="comment_head"> <span class="comment_author"><a href="http://www.cyberciti.biz/tips/about-us" rel="external nofollow" class="url">nixCraft</a></span> <span class="comment_date">May 13, 2012, 8:35 pm</span></div><div class="comment_text grt" id="comment-body-180256"><p><em> &gt; my rules get overwritten by the system flushing my new rules or editing them</em></p><p>I think you got some sort of script or other firewall product running that is overwriting your rules. Check your cron job and you find the source for the same. If you need further assistance head over to the <a href="http://nixcraft.com/forum.php" rel="nofollow">nixcraft Linux Support forum</a>.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180256" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-180274"><div class="comment_head"> <span class="comment_author">kolya</span> <span class="comment_date">May 14, 2012, 12:21 pm</span></div><div class="comment_text grt" id="comment-body-180274"><p>thanks for your respond, as I am not a specialist I didn’t any changes to my crontab yet, anyway I checked it, also /cron.d and everything connected to cron in /var/spool/…. Nothing about iptables or something. What I noticed there are several iptables files in /etc/sysconfig/: iptables.old written by system-config-firewall, iptables generated by iptables-save with some changes what I didn’t entered.<br> Here is what I entered from wiki.centos.org/HowTos/Network/IPTables:</p><p># iptables -P INPUT ACCEPT<br> # iptables -F<br> # iptables -A INPUT -i lo -j ACCEPT<br> # iptables -A INPUT -m state –state ESTABLISHED,RELATED -j ACCEPT<br> # iptables -A INPUT -p tcp –dport 22 -j ACCEPT<br> # iptables -P INPUT DROP<br> # iptables -P FORWARD DROP<br> # iptables -P OUTPUT ACCEPT<br> # iptables -L -v</p><p>Here is what I got in the iptables’s file:</p><p>:INPUT DROP [1:40]<br> :FORWARD DROP [0:0]<br> :OUTPUT ACCEPT [526:43673]<br> -A INPUT -i lo -j ACCEPT<br> -A INPUT -m state –state RELATED,ESTABLISHED -j ACCEPT<br> -A INPUT -p tcp -m tcp –dport 22 -j ACCEPT<br> COMMIT<br> Don’t know why it changes, probably it is aplying kind of default settings, but analyzing this settings the port 22 should be open. Nmap says it is closed, telnet outputs connection refused. Was trying to set samba server with the same result due to my firewall. What to do?</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180274" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-180414"><div class="comment_head"> <span class="comment_author">Sigma</span> <span class="comment_date">May 25, 2012, 6:53 am</span></div><div class="comment_text grt" id="comment-body-180414"><p>Thanks a lot for this article, which is extremely easy to understand and follow for beginners as me!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180414" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-180592"><div class="comment_head"> <span class="comment_author">dima</span> <span class="comment_date">June 9, 2012, 10:38 am</span></div><div class="comment_text grt" id="comment-body-180592"><p>Hi<br> Regarding the block #7.1: Only Block Incoming Traffic<br> The rule<br> # iptables -A INPUT -m state –state NEW,ESTABLISHED -j ACCEPT<br> looks dubious to me<br> Why would you want to allow NEW connections?<br> In my view it should read<br> # iptables -A INPUT -m state –state RELATED,ESTABLISHED -j ACCEPT</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180592" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment even depth-2" id="comment-185686"><div class="comment_head"> <span class="comment_author">qubits4all</span> <span class="comment_date">February 2, 2013, 8:08 am</span></div><div class="comment_text grt" id="comment-body-185686"><p>I noticed this as well. The rule as given is not right. I’ve been using iptables for a couple of years now, and the INPUT rule here should read:<br> iptables -A INPUT -m state –state ESTABLISHED,RELATED<br> (actually the above order is equivalent), because one clearly wouldn’t want to match the NEW state here. Doing so would open up the door to TCP connects (i.e., TCP SYN packets) to any listening TCP services, as well as to UDP datagrams.</p><p>Cheers to the author(s) of nixCraft for a nice article &amp; a useful collection of iptables rules. This has become one of my favorite Linux/Unix blogs, so please keep the articles coming.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-185686" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment odd alt thread-even depth-1" id="comment-180767"><div class="comment_head"> <span class="comment_author">BiBi</span> <span class="comment_date">June 21, 2012, 3:24 am</span></div><div class="comment_text grt" id="comment-body-180767"><p>Thank you very much, this site is very useful. I love all of you.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180767" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-180990"><div class="comment_head"> <span class="comment_author">Juan</span> <span class="comment_date">July 14, 2012, 1:53 pm</span></div><div class="comment_text grt" id="comment-body-180990"><p>Hi.<br> Excellent tutorial. My desire is to block social networking in my job, I did it with squid in transparent mode but skipped to enter https. I did the tests on a virtual pc and it worked fine. The issue is that I is working on the production server. This has two network cards, eth0 traffic where it enters the Internet and eth1 to connect to the network. For the case of Facebook do the following:</p><p># We block Facebook<br> iptables-A OUTPUT-p tcp-d 69.63.176.0/20-dport 443-j DROP<br> iptables-A OUTPUT-p tcp-d 66.220.144.0/20-dport 443-j DROP<br> iptables-A OUTPUT-p tcp-d 69.171.224.0/19-dport 443-j DROP<br> iptables-A OUTPUT-p tcp-d <a href="http://www.facebook.com-dport/" rel="nofollow">http://www.facebook.com-dport</a> 443-j DROP<br> iptables-A OUTPUT-p tcp-d facebook.com-dport 443-j DROP</p><p>Any suggestions?.</p><p>Greetings.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-180990" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-181404"><div class="comment_head"> <span class="comment_author">jaydatt</span> <span class="comment_date">August 30, 2012, 10:47 am</span></div><div class="comment_text grt" id="comment-body-181404"><p>really helpful article</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-181404" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-181494"><div class="comment_head"> <span class="comment_author">Borislav Bozhanov</span> <span class="comment_date">September 11, 2012, 11:13 pm</span></div><div class="comment_text grt" id="comment-body-181494"><p>Hi,</p><p>Here is how to BLOCK FACEBOOK with single line command and iptables:</p><p>for i in $(nslookup facebook.com|grep Address|grep -v “#53″|awk ‘{print $2}’); do iptables -I FORWARD -m tcp -p tcp -d $i/24 –dport 443 -j DROP; done</p><p>You can replace the website with any other secure (https) you want.</p><p>For http websites (non-secure) – use the following line, replacing yahoo.com with the desired domain name:<br> for i in $(nslookup yahoo.com|grep Address|grep -v “#53″|awk ‘{print $2}’); do iptables -I FORWARD -m tcp -p tcp -d $i/24 –dport 80 -j DROP; done</p><p>Don’t forget to save your iptables configuration.</p><p>Regards,<br> Borislav Bozhanov</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-181494" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-181511"><div class="comment_head"> <span class="comment_author"><a href="http://www.online.atm.pl/" rel="external nofollow" class="url">Åukasz Bodziony</a></span> <span class="comment_date">September 13, 2012, 7:37 pm</span></div><div class="comment_text grt" id="comment-body-181511"><p>Thank you!!!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-181511" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-181673"><div class="comment_head"> <span class="comment_author">Gus</span> <span class="comment_date">September 29, 2012, 6:51 pm</span></div><div class="comment_text grt" id="comment-body-181673"><p>Hello.<br> I’m working with virtual machines. and would like to make a firewall and rootin bash.</p><p>My question is this<br> I have several public ip —  IP1 = (200.45.xx.xxx)  IP2 (=200.xx), IP3 = Â·</p><p>The issue is that one of them use to Wan IP1.</p><p>Now I want to direct traffic from outside to inside. But I also want to redirect the traffic that comes to public ip 2  ( IP2 to the local machine in lan ( 192.168.1.2) and what comes to public ip 3 (IP3) to the local machine (192.168.1.3)</p><p>I can not find examples of how to redirect traffic coming to a specific public IP to a particular LAN private IP.<br> If you can ask to help me.</p><pre>#!/bin/sh
## SCRIPT de IPTABLES
## Pello Xabier Altadill Izura
echo -n Aplicando Reglas de Firewall...
## Paramos el ipchains y quitamos el modulo
/etc/rc.d/init.d/firewall stop
rmmod ipchains
## Instalando modulos
modprobe ip_tables
modprobe ip_nat_ftp
modprobe ip_conntrack_ftp
## Variables
IPTABLES=iptables
EXTIF="eth1"
INTIF="eth0"
## En este caso,
## la tarjeta eth1 es la que va al ROUTER y la eth0 la de la LAN
## Primeras reglas
/sbin/iptables -P INPUT DROP
/sbin/iptables -F INPUT
/sbin/iptables -P OUTPUT ACCEPT
/sbin/iptables -F OUTPUT
/sbin/iptables -P FORWARD ACCEPT
/sbin/iptables -F FORWARD
/sbin/iptables -t nat -F
### En principio, si las reglas INPUT por defecto hacen DROP, no haria falta
### meter mas reglas, pero si temporalmente se pasa a ACCEPT no esta de mas.
## Todo lo que viene de cierta IP se deja pasar (administradores remotosâ€¦)
/sbin/iptables -A INPUT -i $EXTIF -s 203.175.34.0/24 -d 0.0.0.0/0 -j ACCEPT
## El localhost se deja
/sbin/iptables -A INPUT -i lo -j ACCEPT
/sbin/iptables -A OUTPUT -o lo -j ACCEPT
## Aceptar al exterior al 80 y al 443
# Permitir salida al 80
/sbin/iptables -A INPUT -i $EXTIF -p tcp --sport 80 -j ACCEPT
/sbin/iptables -A OUTPUT -o $EXTIF -p tcp --dport 80 -j ACCEPT
# Permitir salida al 443
/sbin/iptables -A INPUT -i $EXTIF -p tcp --sport 443 -j ACCEPT
/sbin/iptables -A OUTPUT -o $EXTIF -p tcp --dport 443 -j ACCEPT
## SALIDA SMTP - Para que el servidor se pueda conectar a otros MTA
# Permitir salida SMTP
/sbin/iptables -A INPUT -i $EXTIF -p tcp --sport 25 -j ACCEPT
/sbin/iptables -A OUTPUT -o $EXTIF -p tcp --dport 25 -j ACCEPT
## SALIDA FTP - Para que el servidor se pueda conectar a FTPs
/sbin/iptables -A INPUT -i $EXTIF -p tcp --sport 21 -m state --state ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -o $EXTIF -p tcp --dport 21 -m state --state NEW,ESTABLISHED -j ACCEPT
# ftp activo
/sbin/iptables -A INPUT -i $EXTIF -p tcp --sport 20 -m state --state ESTABLISHED,RELATED -j ACCEPT
/sbin/iptables -A OUTPUT -o $EXTIF -p tcp --dport 20 -m state --state ESTABLISHED -j ACCEPT
# ftp pasivo
/sbin/iptables -A INPUT -i $EXTIF -p tcp --sport 1024:65535 --dport 1024:65535 -m state --state ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -o $EXTIF -p tcp --sport 1024:65535 --dport 1024:65535 -m state --state ESTABLISHED,RELATED -j ACCEPT
</pre></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-181673" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-even depth-1" id="comment-181873"><div class="comment_head"> <span class="comment_author">Rogier</span> <span class="comment_date">October 23, 2012, 5:48 am</span></div><div class="comment_text grt" id="comment-body-181873"><p>Hi, I have two interfaces: eth0 (for internal network) and eth1 (WAN). The server does the routing to the clients with the following IPtables:</p><pre># Generated by iptables-save v1.4.12 on Fri Oct 19 21:14:26 2012
*nat
:PREROUTING ACCEPT [14:1149]
:INPUT ACCEPT [6:625]
:OUTPUT ACCEPT [4:313]
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING -o eth1 -j MASQUERADE
COMMIT
# Completed on Fri Oct 19 21:14:26 2012
# Generated by iptables-save v1.4.12 on Fri Oct 19 21:14:26 2012
*filter
:INPUT ACCEPT [505:53082]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [247:29622]
-A FORWARD -s 192.168.1.0/24 -i eth0 -o eth1 -m conntrack --ctstate NEW -j ACCEPT
-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
COMMIT
# Completed on Fri Oct 19 21:14:26 2012</pre><p>This works fine, however I have no other rules set up. Can anyone help me in deciding what rules I need? the server (who does the NAT) is also running a webserver on port 80, SSH server on 22. All other ports can may be blocked.. how can I achieve this?</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-181873" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment even depth-2" id="comment-181887"><div class="comment_head"> <span class="comment_author">Jorge Robles</span> <span class="comment_date">October 24, 2012, 2:37 pm</span></div><div class="comment_text grt" id="comment-body-181887"><p>I use fwbuilder to create my rules, this interface “looks like” checkpoint’s fw1 client to edit rules.  Very graphical, and good to work with.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-181887" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182041"><div class="comment_head"> <span class="comment_author"><a href="http://www.smscollection.in/" rel="external nofollow" class="url">sahil</a></span> <span class="comment_date">November 8, 2012, 10:14 am</span></div><div class="comment_text grt" id="comment-body-182041"><p>very nice and informative article<br> it really helped to work for my VPS server</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-182041" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-182053"><div class="comment_head"> <span class="comment_author">bussy</span> <span class="comment_date">November 9, 2012, 8:09 pm</span></div><div class="comment_text grt" id="comment-body-182053"><p>how i do give access  ip ex 192.168.0.2 only for facebook .</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-182053" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment odd alt depth-2" id="comment-183979"><div class="comment_head"> <span class="comment_author">Sayajin</span> <span class="comment_date">December 19, 2012, 7:27 am</span></div><div class="comment_text grt" id="comment-body-183979"><p>fb_address=$(dig facebook.com +tcp +short);<br> iptables -A OUTPUT -p tcp -s !192.168.0.2/32 -d $fb_address -j DROP;</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-183979" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-182379"><div class="comment_head"> <span class="comment_author">bahathir</span> <span class="comment_date">November 25, 2012, 3:17 am</span></div><div class="comment_text grt" id="comment-body-182379"><p>For tip #2, it is advisable to run the -P chain ACCEPt first, before flushing it.<br> Exampes<br> # iptables -P INPUT ACCEPT<br> # iptables -P OUTPUT ACCEPT<br> # iptables -P FORWARD ACCEPT<br> # iptables -F<br> # iptables -t nat -F<br> # iptables -X<br> #iptables -t nat -X</p><p>Why? If  the current chain’s policy is DROP, and you are remotely accessing to the server via SSH, and the rule “-A INPUT -p tcp –dport 22 -j ACCEPT” is still opens the “-P INPUT DROP”. you may disconnected as soon as you flush *-F* the rules, and the default policy “-P INPUT DROP” kicks in. :) If you are working on the local console, it is fine.</p><p>Thank you.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-182379" title="permalink to this comment" rel="nofollow">Link</a></div><ul class="children"><li class="comment odd alt depth-2" id="comment-185688"><div class="comment_head"> <span class="comment_author">qubits4all</span> <span class="comment_date">February 2, 2013, 8:34 am</span></div><div class="comment_text grt" id="comment-body-185688"><p>This is a valid point. Another way to avoid locking oneself out, which I have found very useful for testing firewall changes over an SSH session, is the iptables-apply command (incl. with the Ubuntu iptables package for e.g.). It functions essentially the same as the iptables command, but when applying a rule change it prompts w/ a timeout for a confirmation after making the change. If no response is received (in 30 secs. by default), then it rolls back the change (i.e., add, modify, delete or otherwise).</p><p>Once rules have been tested, I save them with iptables-save, and load the stable configuration with an init.d script at system startup (and including support for a ‘restart’ command here, for a clean flush, delete &amp; reapply rules cycle).</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-185688" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></li><li class="comment even thread-even depth-1" id="comment-182478"><div class="comment_head"> <span class="comment_author">levi</span> <span class="comment_date">November 27, 2012, 4:24 am</span></div><div class="comment_text grt" id="comment-body-182478"><p>Could it be you are using iptables save after directly editing? This will overwrite your work. Do a restart to load your newly edited table.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-182478" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-183157"><div class="comment_head"> <span class="comment_author">KeepEnEmUp</span> <span class="comment_date">December 8, 2012, 2:32 am</span></div><div class="comment_text grt" id="comment-body-183157"><p>Great Thx for awesome site and for awesome reading,tutos.<br> Respect And KeepUp dude!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-183157" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-183573"><div class="comment_head"> <span class="comment_author">rashid Iqbal</span> <span class="comment_date">December 13, 2012, 11:43 am</span></div><div class="comment_text grt" id="comment-body-183573"><p>from graphical user and groups If I add or delete any user I can’t see any reference log nor in messages or in /var/log/secure file,</p><p>Kindly please advise on this that from GUI if we run/execute any command where does the log message will go.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-183573" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-185983"><div class="comment_head"> <span class="comment_author">Gangadhar</span> <span class="comment_date">February 27, 2013, 2:50 pm</span></div><div class="comment_text grt" id="comment-body-185983"><p>thank you very much for such a wonderful explanation….. very clear and had nice experience with iptables…</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-185983" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-186345"><div class="comment_head"> <span class="comment_author">haidt</span> <span class="comment_date">March 10, 2013, 9:04 am</span></div><div class="comment_text grt" id="comment-body-186345"><p>Hi there,</p><p> i have a problem, i have got a server and LAN network,  and this’s feature</p><p>internet  (eth0) server (eth1)  clients -&gt; 10.0.0.2<br> -&gt; 10.0.0.3<br> now, i can config to iptables accept all client connect internet, but in this situation, i want to allow only one client (assume: 10.0.0.3), i try but not completed. pls help me :)</p><p>Thanks</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-186345" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190593"><div class="comment_head"> <span class="comment_author">Manish Narnaware</span> <span class="comment_date">April 24, 2013, 5:33 am</span></div><div class="comment_text grt" id="comment-body-190593"><p>Thanks a lot.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-190593" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-190950"><div class="comment_head"> <span class="comment_author"><a href="http://www.orange-papers.org/" rel="external nofollow" class="url">Orange</a></span> <span class="comment_date">April 25, 2013, 11:08 pm</span></div><div class="comment_text grt" id="comment-body-190950"><p>Thank you very much. Coincidentally, I just discovered an hour ago that I need to use iptables to allow a tablet computer to talk through my laptop, using the same internet connection. And then I discovered that I can’t remember any of it. I was using IP tables and IP nat 15 years ago, back when it was Darrin Reed’s project (name???), but that was too long ago for my memory. This article will get me back on track fast.<br> Thanks again.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-190950" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191725"><div class="comment_head"> <span class="comment_author"><a href="http://congnghevps.net/" rel="external nofollow" class="url">Le Vu</a></span> <span class="comment_date">May 29, 2013, 8:23 am</span></div><div class="comment_text grt" id="comment-body-191725"><p>Module xt_connlimit was disabled. How to limit number of connection per IP, can you module limit and recent. Please help me. :)</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-191725" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-191784"><div class="comment_head"> <span class="comment_author">abedatwa</span> <span class="comment_date">June 13, 2013, 7:08 am</span></div><div class="comment_text grt" id="comment-body-191784"><p>thank you</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-191784" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191785"><div class="comment_head"> <span class="comment_author">abedatwa</span> <span class="comment_date">June 13, 2013, 7:09 am</span></div><div class="comment_text grt" id="comment-body-191785"><p>thank you for you ivitation</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-191785" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-192056"><div class="comment_head"> <span class="comment_author">Mark</span> <span class="comment_date">August 1, 2013, 1:33 pm</span></div><div class="comment_text grt" id="comment-body-192056"><p>Thank you for this example. I don’t remember the command line off the top of my head and this gives me enough information to do what I need to do without having to read 30 man pages. If only proper support (support.oracle.com) would be so efficient.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-192056" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192062"><div class="comment_head"> <span class="comment_author">paul</span> <span class="comment_date">August 3, 2013, 1:29 am</span></div><div class="comment_text grt" id="comment-body-192062"><p>Enjoyed and appreciated the article and the comments particularly from noone  (13 December 2011).  I’ve added some of the suggestions to my firewalls.</p><p>The first lines in every INPUT are always</p><p>-A INPUT -s 123.123.123.123/32 -j ACCEPT<br> -A INPUT -s 124.124.124.124/32 -j ACCEPT</p><p>123 &amp; 124 represent my external IPs including home and office backup connections.</p><p>These entries ensure that whatever errors I make in IPTables I can never lock myself out of my remote servers.</p><p>Best regards to all,</p><p>Paul.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-192062" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-192147"><div class="comment_head"> <span class="comment_author">John</span> <span class="comment_date">August 21, 2013, 2:40 am</span></div><div class="comment_text grt" id="comment-body-192147"><p>In 7.1, the example provided does not block all incoming traffic like it claims.  If you don’t add more parameters, the rule will apply to both directions.</p><p>The example rule:</p><p> iptables -I INPUT -m state –state NEW,ESTABLISHED -j ACCEPT</p><p>This would not only allow for NEW outgoing requests but also NEW incoming requests.  The DROP policy for the INPUT chain can’t do it’s job to block incoming connections since it is applied after the rule which allows both NEW incoming and outgoing connections.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-192147" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193135"><div class="comment_head"> <span class="comment_author">sophea</span> <span class="comment_date">October 30, 2013, 8:53 am</span></div><div class="comment_text grt" id="comment-body-193135"><p>I have problem when i add by manually (ex: #iptables -A INPUT -s 192.168.0.1 -p tcp –dport 53 -j ACCEP) but when i restart iptables by service iptables restart it not work because :</p><p>1- when i view in /etc/sysconfig/iptables the IP address will be 192.168.0.1/32 but my land /24<br> 2- problem when i start or stop by system-config-firewall</p><p>Can u help me pls?</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-193135" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-205008"><div class="comment_head"> <span class="comment_author">Mohammad</span> <span class="comment_date">February 27, 2014, 3:38 pm</span></div><div class="comment_text grt" id="comment-body-205008"><p>Hi, I have a question. Could we log packets which are dropped because of forwarding queue is filled (e.g in congestion time)? How do I perform this work?<br> Regards Mohammad.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-205008" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274464"><div class="comment_head"> <span class="comment_author">juan-vargas</span> <span class="comment_date">May 26, 2014, 12:49 am</span></div><div class="comment_text grt" id="comment-body-274464"><p>Hi there. Greetings from Mexico. Nice examples. Very usefull all of them. But, can I bypass traffic in the port-80 once my iptables-policies are: -P INPUT DROP, -P OUTPUT DROP, -P FORWARD DROP?</p><p>thank you all in advance.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-274464" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-301489"><div class="comment_head"> <span class="comment_author">Anumod</span> <span class="comment_date">August 4, 2014, 12:47 pm</span></div><div class="comment_text grt" id="comment-body-301489"><p>How to disable sending back TCP Reset to clients or how to increase TCP reset timeout in iptable.<br> (I am using a raw socket as server and able to receive tcp client SYN request, but before sending SYNACK, tcp reset packet is going from server)</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-301489" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-302788"><div class="comment_head"> <span class="comment_author">John</span> <span class="comment_date">August 9, 2014, 1:20 am</span></div><div class="comment_text grt" id="comment-body-302788"><p>Hi Guys,</p><p>New to IP Tables, need a little advice – I have a guest wifi network setup, how do I block port 25 outgoing for an ip range?</p><p>Thanks, John Tankard</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-302788" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-364824"><div class="comment_head"> <span class="comment_author">Darko Vrsic</span> <span class="comment_date">October 15, 2014, 9:30 am</span></div><div class="comment_text grt" id="comment-body-364824"><p>Very nice!</p><p>Thank you!</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-364824" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-365082"><div class="comment_head"> <span class="comment_author">Bas</span> <span class="comment_date">October 15, 2014, 5:52 pm</span></div><div class="comment_text grt" id="comment-body-365082"><p>Nice breakdown on iptables!</p><p>However, I prefer (&amp; recommend) to use a firewall manager (command-line / config file based tool) like shorewall:</p><p><a href="http://shorewall.net/" rel="nofollow">http://shorewall.net/</a></p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-365082" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-440343"><div class="comment_head"> <span class="comment_author"><a href="http://falkland-islands.tumblr.com/" rel="external nofollow" class="url">Ron Barak</a></span> <span class="comment_date">December 1, 2014, 4:43 pm</span></div><div class="comment_text grt" id="comment-body-440343"><p>Useful page.<br> Here’XXX errXXX I found<br> #18: Established Connections and &gt;&gt;&gt;Restaring&lt;&lt;&lt; The Firewall</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-440343" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-440346"><div class="comment_head"> <span class="comment_author"><a href="http://falkland-islands.tumblr.com/" rel="external nofollow" class="url">Ron Barak</a></span> <span class="comment_date">December 1, 2014, 4:44 pm</span></div><div class="comment_text grt" id="comment-body-440346"><p>Useful page.<br> Here’s errtum I found<br> #18: Established Connections and &gt;&gt;&gt;Restaring&lt;&lt;&lt; The Firewall</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-440346" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-580011"><div class="comment_head"> <span class="comment_author">Ramesh Das</span> <span class="comment_date">April 6, 2015, 7:32 pm</span></div><div class="comment_text grt" id="comment-body-580011"><p>iptables -p tcp –syn –dport 80 -m connlimit –connlimit-above 20 –connlimit-mask 24 -j DROP</p><p>I tried above but its not taking through so if am not wrong then it should be as below.</p><p>iptables  -A INPUT -p tcp –syn –dport 80 -m connlimit –connlimit-above 20 –connlimit-mask 24 -j DROP</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-580011" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-623882"><div class="comment_head"> <span class="comment_author">Priscila</span> <span class="comment_date">December 14, 2015, 4:11 am</span></div><div class="comment_text grt" id="comment-body-623882"><p>The reason why so many poplee use VIM is because it is a text editor that you can use right in the command line and it has so many powerful features. People find that once they get used to using VIM that it is</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-623882" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-635337"><div class="comment_head"> <span class="comment_author">Imran Khan</span> <span class="comment_date">February 7, 2016, 11:59 am</span></div><div class="comment_text grt" id="comment-body-635337"><p>Hello Team,</p><p>Gr8 Iptables notes. Will try &amp; share if found any discripency on command.</p><p>Thanks,</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-635337" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-646072"><div class="comment_head"> <span class="comment_author">davidrom</span> <span class="comment_date">April 29, 2016, 9:06 am</span></div><div class="comment_text grt" id="comment-body-646072"><p>you just have to make sure they’re in the correct order.   #18: Established Connections and &gt;&gt;&gt;Restaring&lt;&lt;&lt; The  Linux Firewall</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-646072" title="permalink to this comment" rel="nofollow">Link</a></div></li><li class="comment even thread-even depth-1" id="comment-646156"><div class="comment_head"> <span class="comment_author">Chá»‘ng Trá»™m Quáº£ng NgÃ£i</span> <span class="comment_date">April 30, 2016, 3:36 am</span></div><div class="comment_text grt" id="comment-body-646156"><p>CSF firewall base on iptables is very good for me. I think new SysAdmins should using CSF firewall.</p></div><div class="comment_footer"> <a class="comment_permalink" href="#comment-646156" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul></div><div class="prev_next"><p class="next_post">Next post: <a href="http://www.cyberciti.biz/tips/linux-unix-xsnow.html" rel="next">Linux / UNIX Desktop Fun: Let it Snow On Your Desktop</a></p><p class="previous_post">Previous post: <a href="http://www.cyberciti.biz/tips/centos-linux-6-1-download-cd-dvd-iso.html" rel="prev">Download CentOS 6.1 CD / DVD ISO</a></p></div></div><div style="position: relative; overflow: visible; box-sizing: border-box; min-height: 1px;" class="sidebar"><div style="padding-top: 1px; padding-bottom: 1px; position: static;" class="theiaStickySidebar"><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget"><div id="bsap_1304534" class="bsarocks bsap_bccb43591680e039e32e874cbcc9e431"></div></div></div><div class="widget search-form" id="thesis-search-widget-5"><form class="search_form" method="get" action="http://www.cyberciti.biz/tips"><p> <input class="input_text" id="s" name="s" value="To search, type and hit enter" type="text"> <input id="searchsubmit" value="Search" type="hidden"></p></form></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget"><center> <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 600px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="3521177162"></ins>  </center></div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><p class="widget_title">Featured Articles:</p><div class="textwidget"><ul><li><a href="http://www.cyberciti.biz/open-source/30-cool-best-open-source-softwares-of-2013/">30 Cool Open Source Software I Discovered in 2013</a></li><li><a href="http://www.cyberciti.biz/tips/bash-aliases-mac-centos-linux-unix.html">30 Handy Bash Shell Aliases For Linux / Unix / Mac OS X</a></li><li><a href="http://www.cyberciti.biz/networking/nmap-command-examples-tutorials/">Top 30 Nmap Command Examples For Sys/Network Admins</a></li><li><a href="http://www.cyberciti.biz/tips/php-security-best-practices-tutorial.html">25 PHP Security Best Practices For Sys Admins</a></li><li><a href="http://www.cyberciti.biz/tips/top-linux-monitoring-tools.html">20 Linux System Monitoring Tools Every SysAdmin Should Know</a></li><li><a href="http://www.cyberciti.biz/tips/linux-security.html">20 Linux Server Hardening Security Tips</a></li><li><a href="#">Linux: 20 Iptables Examples For New SysAdmins</a></li><li><a href="http://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html">Top 20 OpenSSH Server Best Security Practices </a></li><li><a href="http://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html">Top 20 Nginx WebServer Best Security Practices</a></li><li><a href="http://www.cyberciti.biz/tips/check-unix-linux-configuration-file-for-syntax-errors.html">20 Examples: Make Sure Unix / Linux Configuration Files Are Free From Syntax Errors</a></li><li><a href="http://www.cyberciti.biz/open-source/best-terminal-applications-for-linux-unix-macosx/">15 Greatest Open Source Terminal Applications Of 2012</a></li><li><a href="http://www.cyberciti.biz/tips/my-10-unix-command-line-mistakes.html">My 10 UNIX Command Line Mistakes</a></li><li><a href="http://www.cyberciti.biz/tips/open-source-project-management-software.html">Top 10 Open Source Web-Based Project Management Software</a></li><li><a href="http://www.cyberciti.biz/tips/download-email-client-for-linux-mac-osx-windows.html">Top 5 Email Client For Linux, Mac OS X, and Windows Users</a></li><li><a href="http://www.cyberciti.biz/tips/linux-laptop.html">The Novice Guide To Buying A Linux Laptop</a></li></ul></div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget">  <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 1057px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="6636490668"></ins> </div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><p class="widget_title">Don’t Miss Any Linux Tips</p><div class="textwidget"><form style="border: 1px solid rgb(204, 204, 204); padding: 3px; text-align: center;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow"><p>Get nixCraft in your inbox. It's free:</p><p><input value="Your email address" style="width: 140px;" name="email" type="text"></p><input value="Nixcraft-LinuxFreebsdSolarisTipsTricks" name="uri" type="hidden"><input name="loc" value="en_US" type="hidden"><input value="Subscribe" type="submit"></form></div></div><div class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div class="textwidget"><center> <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;" data-ad-client="ca-pub-7825705102693166" data-ad-slot="2272802261"></ins>  </center></div></div></div></div></div><div class="footer"> ©2000-2016 nixCraft. All rights reserved. <a href="http://www.cyberciti.biz/tips/privacy">Privacy</a> - <a href="http://www.cyberciti.biz/tips/disclaimer">Terms of Service</a> - <a href="http://www.cyberciti.biz/tips/contact-us">Questions or Comments</a></div></div><div data-theiastickysidebar-sidebarselector="&quot;#secondary, #sidebar, .sidebar, #primary&quot;" data-theiastickysidebar-options="{&quot;containerSelector&quot;:&quot;&quot;,&quot;additionalMarginTop&quot;:0,&quot;additionalMarginBottom&quot;:0,&quot;updateSidebarHeight&quot;:false,&quot;minWidth&quot;:0,&quot;sidebarBehavior&quot;:&quot;stick-to-bottom&quot;,&quot;disableOnResponsiveLayouts&quot;:true}"></div>







</body>
</html>
